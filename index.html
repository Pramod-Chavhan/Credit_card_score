<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Credit Score Prediction</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>


  <style>
    body {
      background: url('https://imgs.search.brave.com/BabatrNjMBWe5-9tHISZu491N2MOvc1ef_zgnx503UI/rs:fit:500:0:0:0/g:ce/aHR0cHM6Ly90My5m/dGNkbi5uZXQvanBn/LzA2LzkzLzM0LzE4/LzM2MF9GXzY5MzM0/MTgzM19XNzl0UTBj/RDJOb3JYOTZ5VnVp/c3Y4amZ3cjM3c3RV/aS5qcGc') no-repeat center center fixed;
      background-size: cover;
      position: relative;
      min-height: 100vh;
      font-family: 'Segoe UI', sans-serif;
    }

    body::before {
      content: "";
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 0;
    }

    .container {
      position: relative;
      z-index: 1;
    }

    .card {
      backdrop-filter: blur(px);
      background: rgba(255, 255, 255, 0.15);
      border-radius: 1.5rem;
      box-shadow: 0 12px 35px rgba(0, 0, 0, 0.3);
      padding: 2rem;
      margin-top: 2rem;
      color: #fff;
    }

    h2 {
      font-weight: 700;
      color: #00f7ff;
    }

    .form-label {
      font-weight: 500;
      color: #ffffff;
    }

    .form-control {
      border-radius: 0.5rem;
      background-color: rgba(188, 228, 239, 0.85);
      color: #000;
    }

    .btn-primary {
      background: linear-gradient(to right, #38b000, #70e000);
      border: none;
      font-weight: bold;
      border-radius: 0.5rem;
      padding: 12px;
      transition: all 0.3s ease-in-out;
      color: white;
    }

    .btn-primary:hover {
      background: linear-gradient(to right, #2d6a4f, #52b788);
      transform: scale(1.03);
    }

    .form-icon {
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      color: #52b788;
    }

    .input-group-icon {
      position: relative;
    }

    .input-group-icon input {
      padding-left: 2.2rem;
    }

    .header-image {
      max-width: 80px;
    }

    .gauge-container {
      max-width: 300px;
      margin: 20px auto;
    }

    .lottie-box {
      width: 150px;
      margin: 10px auto;
    }

    .alert-info {
      background-color: rgba(255, 255, 255, 0.85);
      color: #1b4332;
      font-weight: bold;
    }
  </style>
</head>
<body>
<div class="container">
  <div class="row justify-content-center">
    <div class="col-lg-10">
      <div class="card text-center">
        <img src="https://cdn-icons-png.flaticon.com/512/9424/9424269.png" class="header-image" alt="Credit Score"/>
        <h2>Credit Score Prediction</h2>
        <form method="POST" action="/predict">
          <div class="row">
            {% for field in [
              ['Age', 'Age', 'bi-person'],
              ['Annual Income', 'Annual_Income', 'bi-cash-stack'],
              ['Monthly In-hand Salary', 'Monthly_Inhand_Salary', 'bi-wallet2'],
              ['Number of Bank Accounts', 'Num_Bank_Accounts', 'bi-bank'],
              ['Number of Credit Cards', 'Num_Credit_Card', 'bi-credit-card'],
              ['Interest Rate', 'Interest_Rate', 'bi-percent'],
              ['Number of Loans', 'Num_of_Loan', 'bi-journal-richtext'],
              ['Delay from Due Date (avg days)', 'Delay_from_due_date', 'bi-calendar-x'],
              ['Number of Delayed Payments', 'Num_of_Delayed_Payment', 'bi-alarm'],
              ['Changed Credit Limit (%)', 'Changed_Credit_Limit', 'bi-graph-up'],
              ['Number of Credit Inquiries', 'Num_Credit_Inquiries', 'bi-search'],
              ['Credit Mix (0: Bad, 1: Standard, 2: Good)', 'Credit_Mix', 'bi-diagram-3'],
              ['Outstanding Debt', 'Outstanding_Debt', 'bi-exclamation-diamond'],
              ['Credit Utilization Ratio', 'Credit_Utilization_Ratio', 'bi-pie-chart'],
              ['Credit History Age', 'Credit_History_Age', 'bi-clock-history'],
              ['Payment of Min Amount (0 or 1)', 'Payment_of_Min_Amount', 'bi-check2-square'],
              ['Total EMI per Month', 'Total_EMI_per_month', 'bi-calendar-check'],
              ['Amount Invested Monthly', 'Amount_invested_monthly', 'bi-piggy-bank'],
              ['Monthly Balance', 'Monthly_Balance', 'bi-bar-chart']
            ] %}
            <div class="col-md-6 mb-3">
              <label class="form-label">{{ field[0] }}</label>
              <div class="input-group-icon">
                <i class="bi {{ field[2] }} form-icon"></i>
                <input type="number" class="form-control" name="{{ field[1] }}" required>
              </div>
            </div>
            {% endfor %}
          </div>
          <button type="submit" class="btn btn-primary mt-3">Predict Credit Score</button>
        </form>

        {% if prediction_text %}
        <div class="mt-4">
        <div class="alert alert-info">{{ prediction_text }}</div>
        <div class="gauge-container">
            <canvas id="scoreGauge"></canvas>
        </div>
        <div class="lottie-box">
            <lottie-player
            src="https://assets5.lottiefiles.com/packages/lf20_j1adxtyb.json"
            background="transparent"
            speed="1"
            style="width: 100%; height: 100%;"
            loop autoplay>
            </lottie-player>
        </div>
        </div>
        <script>
            const predictionScore = parseFloat("{{ prediction_score }}") || 0;
          
            // Set color based on score
            let scoreColor = '#dc3545'; // Red
            if (predictionScore >= 70) {
              scoreColor = '#28a745'; // Green
            } else if (predictionScore >= 40) {
              scoreColor = '#ffc107'; // Yellow
            }
          
            const ctx = document.getElementById('scoreGauge').getContext('2d');
          
            new Chart(ctx, {
              type: 'doughnut',
              data: {
                labels: ['Score', 'Remaining'],
                datasets: [{
                  data: [predictionScore, 100 - predictionScore],
                  backgroundColor: [scoreColor, '#f0f0f0'],
                  borderWidth: 0
                }]
              },
              options: {
                cutout: '70%',
                animation: {
                  animateRotate: true,
                  duration: 1500
                },
                plugins: {
                  legend: { display: false },
                  tooltip: { enabled: false },
                  datalabels: {
                    display: true,
                    formatter: function(value, context) {
                      if (context.dataIndex === 0) {
                        return predictionScore.toFixed(0) + '%';
                      }
                      return '';
                    },
                    color: '#000',
                    font: {
                      size: 24,
                      weight: 'bold'
                    },
                    anchor: 'center',
                    align: 'center'
                  }
                }
              },
              plugins: [ChartDataLabels]
            });
          </script>
{% endif %}
</body>
</html>